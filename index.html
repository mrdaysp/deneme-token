<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fenoken DApp</title>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.7.4/dist/web3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
        }

        #walletSection {
            margin: 30px 0;
        }

        .button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: 0.3s;
        }

        .connect-btn {
            background: #4CAF50;
            color: white;
        }

        .disconnect-btn {
            background: #f44336;
            color: white;
        }

        .wallet-info {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 20px auto;
            max-width: 400px;
        }

        .address {
            font-family: monospace;
            word-break: break-all;
        }
    </style>
</head>
<body>
    <h1>Fenoken DApp</h1>
    
    <div id="walletSection">
        <button id="connectButton" class="button connect-btn">ðŸ”— CÃ¼zdanÄ± BaÄŸla</button>
        <div id="walletInfo" class="wallet-info" style="display: none;">
            <p>Connected Address: <span id="walletAddress" class="address"></span></p>
            <p>Network: <span id="networkInfo"></span></p>
            <button id="disconnectButton" class="button disconnect-btn">ðŸšª BaÄŸlantÄ±yÄ± Kes</button>
        </div>
    </div>

    <script>
        let web3;
        let currentAccount;

        // Sayfa yÃ¼klendiÄŸinde cÃ¼zdan kontrolÃ¼
        window.addEventListener('load', async () => {
            if (typeof window.ethereum !== 'undefined') {
                web3 = new Web3(window.ethereum);
                
                // Ã–nceden baÄŸlÄ± hesabÄ± kontrol et
                const accounts = await web3.eth.getAccounts();
                if (accounts.length > 0) {
                    currentAccount = accounts[0];
                    updateWalletUI();
                }

                // MetaMask event listener'larÄ±
                window.ethereum.on('accountsChanged', (accounts) => {
                    currentAccount = accounts[0] || null;
                    updateWalletUI();
                });

                window.ethereum.on('chainChanged', () => {
                    window.location.reload();
                });
            }
        });

        // CÃ¼zdan BaÄŸlama Fonksiyonu
        document.getElementById('connectButton').addEventListener('click', async () => {
            try {
                if (!window.ethereum) {
                    alert('LÃ¼tfen MetaMask yÃ¼kleyin!');
                    return;
                }

                await window.ethereum.request({ method: 'eth_requestAccounts' });
                const accounts = await web3.eth.getAccounts();
                currentAccount = accounts[0];
                updateWalletUI();
            } catch (error) {
                console.error('BaÄŸlantÄ± hatasÄ±:', error);
                alert('BaÄŸlantÄ± baÅŸarÄ±sÄ±z: ' + error.message);
            }
        });

        // BaÄŸlantÄ±yÄ± Kesme Fonksiyonu
        document.getElementById('disconnectButton').addEventListener('click', () => {
            currentAccount = null;
            document.getElementById('walletInfo').style.display = 'none';
            document.getElementById('connectButton').style.display = 'block';
        });

        // AÄŸ Bilgisini GÃ¼ncelle
        async function updateNetworkInfo() {
            const networkId = await web3.eth.getChainId();
            const networks = {
                1: 'Ethereum Mainnet',
                3: 'Ropsten Testnet',
                56: 'Binance Smart Chain',
                137: 'Polygon Mainnet'
            };
            document.getElementById('networkInfo').textContent = networks[networkId] || `Bilinmeyen AÄŸ (ID: ${networkId})`;
        }

        // UI GÃ¼ncelleme
        async function updateWalletUI() {
            if (currentAccount) {
                document.getElementById('connectButton').style.display = 'none';
                document.getElementById('walletInfo').style.display = 'block';
                document.getElementById('walletAddress').textContent = 
                    `${currentAccount.substring(0, 6)}...${currentAccount.substring(38)}`;
                await updateNetworkInfo();
            }
        }
    </script>
</body>
</html>
